---
title: "Adding arrows to ggswim"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

In certain scenarios, it can be useful to visually indicate the continuation of specific records in a swimmer plot. This is where the optional feature of adding arrows to the tail ends of swimmer plot lanes in ggswim comes in handy. Example use cases include illustrating the ongoing care of patients or highlighting record "survival" statuses.

Behind the scenes, the inclusion of arrows is facilitated by a call to `ggplot2::geom_segment()`, coupled with some fine-tuning. While the segments themselves have zero length, the arrows are made possible with a defined length parameter. Within `ggswim()`, users have full control over this length, along with options for color, fill, and type (refer to `?ggswim` for detailed information).

Let's dive into an example, similar to the one we've been using in the README, to see this feature in action.

```{r}
library(ggswim)

ggswim(
  patient_data,
  mapping = aes(
    x = delta_t0_months,
    y = pt_id, fill =
      disease_assessment_status
  )
)
```

Before we can incorporate arrows into our swimmer plot, we need to designate a boolean column that informs `ggswim()` when to append an arrow to a specific row. In our example using `patient_status`, this column is named `arrow_status` and takes on `TRUE` or `FALSE` values to denote a patient's study status at the time of plotting.

```{r}
patient_data |>
  rmarkdown::paged_table()
```

Let's add the arrows onto the plot from before:

```{r}
ggswim(
  patient_data,
  mapping = aes(
    x = delta_t0_months,
    y = pt_id, fill =
      disease_assessment_status
  ),
  arrow = arrow_status
)
```

Default values are set for arrows, but can be manipulated for different aesthetic preferences. Below we add color and fill specifiers, as well as a specification for `arrow_neck_length`. `arrow_neck_length` sets a default proportional value, but can also accept numeric values or reference to a column of numeric values in the dataset. In this case, we use `delta_today` to specify that the neck length should be equivalent to the length of time from the last time point to "today."

```{r}
ggswim(
  patient_data,
  mapping = aes(x = delta_t0_months, y = pt_id, fill = disease_assessment_status),
  arrow = arrow_status,
  arrow_fill = "cyan",
  arrow_colour = "slateblue",
  arrow_head_length = grid::unit(.25, "inches"),
  arrow_neck_length = delta_today,
  width = 0.25
)
```
