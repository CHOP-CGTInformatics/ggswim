---
title: "Adding arrows to ggswim"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 12,
  fig.height = 6
)
```

It can be useful to visually indicate the continuation of specific records in a swimmer plot. Optionally adding arrows to the tail ends of swimmer plot lanes in ggswim can help communicate subject survival status, such as whether or not a subject is still on a given study.

Behind the scenes, the inclusion of arrows is facilitated by a call to `ggplot2::geom_segment()`. ggswim sets the segment length to 0, so that assigned arrows are always placed on the right side of indicated subjects. Within `ggswim()`, users have full control over arrow neck and head length, along with options for color, fill, and type (refer to `?ggswim` for detailed information).

Let's dive into an example similar to that in the README:

```{r}
library(ggswim)

ggswim(
  patient_data,
  mapping = aes(
    x = delta_t0_months,
    y = pt_id, fill =
      disease_assessment_status
  )
)
```

Before we can incorporate arrows into our swimmer plot, we need to designate a boolean column that informs `ggswim()` when to append an arrow to a specific row. In our example using `patient_status`, this column is named `arrow_status` and takes on `TRUE` or `FALSE` values to denote a patient's study status at the time of plotting.

```{r}
patient_data |>
  rmarkdown::paged_table()
```

Let's add the arrows onto the plot from before:

```{r}
ggswim(
  patient_data,
  mapping = aes(
    x = delta_t0_months,
    y = pt_id, fill =
      disease_assessment_status
  ),
  arrow = arrow_status
)
```

Default values are set for arrows, but can be manipulated for different aesthetic preferences. Below we add color and fill specifiers, as well as a specification for `arrow_neck_length`. `arrow_neck_length` sets a default proportional value, but can also accept numeric values or reference to a column of numeric values in the dataset. In this case, we use `delta_today` to specify that the neck length should be equivalent to the length of time from the last time point to "today."

```{r}
ggswim(
  patient_data,
  mapping = aes(x = delta_t0_months, y = pt_id, fill = disease_assessment_status),
  arrow = arrow_status,
  arrow_fill = "cyan",
  arrow_colour = "slateblue",
  arrow_head_length = grid::unit(.25, "inches"),
  arrow_neck_length = delta_today,
  width = 0.25
)
```
